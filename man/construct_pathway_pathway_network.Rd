% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/construct_pathway_pathway_network.R
\name{construct_pathway_pathway_network}
\alias{construct_pathway_pathway_network}
\title{Pathway-pathway network construction}
\usage{
construct_pathway_pathway_network(
  abundance_file,
  metadata_file,
  map_file,
  output_file,
  file_type = c("csv", "tsv"),
  pvalueCutoff,
  pAdjustMethod = c("fdr", "holm", "hochberg", "hommel", "bonferroni", "BH", "BY",
    "none"),
  rank_by = c("signed_log_pvalue", "log2FoldChange")
)
}
\arguments{
\item{abundance_file}{A character string specifying the path to the
gene abundance data file. The first column should be gene IDs,
and subsequent columns should be sample counts (integers).}

\item{metadata_file}{A character string specifying the path to the sample metadata file.
Must include 'SampleID' and 'class' columns.}

\item{map_file}{A character string specifying the path to the
pathway-to-gene mapping file. Expected to be a two-column CSV/TSV
where the first column is Pathway ID and the second is Gene ID.}

\item{output_file}{A character string specifying the path to the directory
where output CSV files (GSEA results and Jaccard indices) will be saved.
The directory will be created if it does not exist.}

\item{file_type}{A character string indicating the type of input files.
Must be "csv" (for comma-separated) or "tsv" (for tab-separated).}

\item{pvalueCutoff}{A numeric value specifying the adjusted p-value cutoff
for determining significance in GSEA results.}

\item{pAdjustMethod}{A character string specifying the method for p-value
adjustment. Must be one of "fdr" (False Discovery Rate), "holm", "hochberg",
"hommel", "bonferroni", "BH", "BY", or "none".}

\item{rank_by}{A character string specifying the method to rank genes for GSEA.
Must be either "signed_log_pvalue" (sign of log2FoldChange * -log10(p-value))
or "log2FoldChange".}
}
\value{
Invisible \code{NULL}. The function's primary output is CSV files saved to the specified \code{output_file} directory, containing GSEA results and pathway Jaccard indices for each comparison.
}
\description{
This function performs differential expression analysis (using DESeq2) and
Gene Set Enrichment Analysis (GSEA) to identify enriched pathways and
subsequently computes Jaccard indices to quantify overlap between core
enrichment genes of significant pathways. It allows for flexible p-value
adjustment and gene ranking methods.
}
\details{
The overall workflow includes:
1. Loading gene abundance, sample metadata, and pathway-to-gene mapping files.
2. Preparing data for DESeq2, including sample alignment and rounding counts.
3. Performing DESeq2 differential expression analysis for all pairwise
   comparisons between conditions defined in the metadata.
4. Reshaping the pathway mapping file into the `clusterProfiler` TERM2GENE format.
5. Running GSEA for each pairwise comparison, ranking genes by either
   signed log10 p-value or log2FoldChange.
6. Saving the GSEA results for each comparison.
7. Calculating Jaccard indices between core enrichment gene sets of significant
   pathways within each comparison, saving these overlap results.
}
