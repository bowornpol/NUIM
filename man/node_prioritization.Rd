% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/node_prioritization.R
\name{node_prioritization}
\alias{node_prioritization}
\title{Node prioritization using Laplacian Heat Diffusion (LHD) algorithm}
\usage{
node_prioritization(
  multi_layered_network_file,
  output_directory,
  time_step_interval = 0.01,
  stabilization_threshold = 1e-04,
  stabilization_window_size = 10,
  filter_other_metabolite_edges
)
}
\arguments{
\item{multi_layered_network_file}{A character string specifying the path to the
CSV file containing the integrated multi-layered network data (e.g., output
from `construct_multi_layered_network`). Expected columns: 'Feature1',
'Feature2', 'Edge_Score' (numeric), and 'Edge_Type'.}

\item{output_directory}{A character string specifying the path to the directory
where the output CSV files (heat scores, correlation data) and plots (correlation
plots) will be saved. The directory will be created if it does not exist.}

\item{time_step_interval}{A numeric value representing the interval between
time steps for the heat diffusion simulation (e.g., 0.01).}

\item{stabilization_threshold}{A numeric value defining the threshold for
determining stabilization. If the absolute difference in Spearman correlation
between successive heat vectors falls below this threshold for a specified
window, the process is considered stabilized.}

\item{stabilization_window_size}{An integer specifying the number of consecutive
time steps over which the correlation difference must remain below the
`stabilization_threshold` for stabilization to be declared.}

\item{filter_other_metabolite_edges}{A logical value. If `TRUE`, when a
metabolite is used as a seed, all other edges connected to *other* metabolite
nodes (i.e., not the current seed) are excluded from the network for that
specific diffusion run. This isolates the diffusion to pathways and other
non-metabolite nodes. If `FALSE`, the full network is used for each seed.}
}
\value{
The function's primary output consists of multiple
  CSV files (heat scores and correlation data) and JPG plots (correlation plots),
  saved to the specified `output_directory`, one set for each metabolite seed node.
}
\description{
This function implements Laplacian Heat Diffusion (LHD) algorithm
on a multi-layered network to prioritize nodes based on their
influence from specific metabolite seed nodes. It simulates the diffusion
of "heat" through the network until a stable state is reached, and then
quantifies each node's heat score. It also generates a plot showing the
stabilization of the heat diffusion process.
}
\details{
The process involves:
1. Loading the integrated multi-layered network data.
2. Identifying all unique metabolite nodes, which serve as seed points for diffusion.
3. For each metabolite seed:
   a. Optionally filters the network to exclude all other metabolite nodes and their connected edges
      if `filter_other_metabolite_edges` is `TRUE`.
   b. Converts edge scores to absolute values and constructs an `igraph` object.
   c. Computes the graph Laplacian matrix.
   d. Initializes a heat vector with heat concentrated on the current seed node.
   e. Simulates heat diffusion over time steps using matrix exponentials.
   f. Determines the stabilization time by monitoring the Spearman correlation
      between successive heat vectors.
   g. Calculates final heat scores for all nodes at the stabilization time.
   h. Saves the heat scores and the correlation-over-time data to CSV files.
   i. Generates and saves a ggplot2 visualization of the Spearman correlation
      over time, indicating the stabilization point.
}
\references{
Carlin DE, Demchak B, Pratt D, Sage E, Ideker T. Network propagation in the cytoscape cyberinfrastructure. PLoS computational biology. 2017;13(10):e1005598.
}
