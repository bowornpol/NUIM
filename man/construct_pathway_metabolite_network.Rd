% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/construct_pathway_metabolite_network.R
\name{construct_pathway_metabolite_network}
\alias{construct_pathway_metabolite_network}
\title{Pathway-metabolite network construction}
\usage{
construct_pathway_metabolite_network(
  pathway_abundance_file,
  metabolite_concentration_file,
  gsea_results_file,
  metadata_file,
  output_file,
  correlation_method = c("spearman", "pearson"),
  filter_by = c("none", "p_value", "q_value"),
  corr_cutoff,
  p_value_cutoff,
  q_value_cutoff,
  q_adjust_method = c("bonferroni", "fdr")
)
}
\arguments{
\item{pathway_abundance_file}{A character string specifying the path to the
CSV file containing pathway abundance data. Expected: Pathways as rows,
samples as columns, with the first column being pathway IDs.}

\item{metabolite_concentration_file}{A character string specifying the path
to the CSV file containing metabolite concentration data. Expected: Samples
as rows, metabolites as columns, with the first column being sample IDs.}

\item{gsea_results_file}{An optional character string specifying the path
to a GSEA results CSV file (e.g., from `construct_pathway_pathway_network`).
If provided, pathways will be filtered to those present in this file, and
the filename might influence group processing. Set to `NULL` if not used.}

\item{metadata_file}{An optional character string specifying the path to the
CSV file containing sample metadata. Must include 'SampleID' and 'class'
columns if provided. If `NULL`, all samples are treated as a single 'overall' group.}

\item{output_file}{A character string specifying the path to the directory
where the output CSV files (correlation results) will be saved.
The directory will be created if it does not exist.}

\item{correlation_method}{A character string specifying the correlation method.
Must be "spearman" or "pearson".}

\item{filter_by}{A character string specifying how to filter the correlation
results. Must be "none", "p_value", or "q_value".}

\item{corr_cutoff}{A numeric value specifying the absolute correlation
coefficient cutoff. Only correlations with an absolute value greater than
or equal to this cutoff will be kept.}

\item{p_value_cutoff}{A numeric value specifying the p-value cutoff. Required
if `filter_by` is "p_value".}

\item{q_value_cutoff}{A numeric value specifying the q-value (adjusted p-value)
cutoff. Required if `filter_by` is "q_value".}

\item{q_adjust_method}{A character string specifying the method for q-value
(p-value) adjustment. Must be "bonferroni" or "fdr" (False Discovery Rate).
Used if `filter_by` is "q_value".}
}
\value{
The function's primary output is CSV files saved
  to the specified `output_file` directory, containing the filtered pathway-metabolite
  correlation results for each processed group.
}
\description{
This function calculates correlations between pathway abundances and metabolite
concentrations, optionally filtering results based on GSEA findings and
statistical significance. It supports both Spearman and Pearson correlation
methods and various p-value/q-value adjustment options.
}
\details{
The function performs the following key steps:
1. Loads pathway abundance, metabolite concentration, and optional GSEA results
   and metadata files.
2. Prepares data by aligning samples across datasets and converting pathway
   abundances to relative values.
3. Optionally filters pathways based on identifiers found in a provided GSEA
   results file.
4. Determines groups for correlation analysis based on metadata, with priority
   given to a specific group implied by the GSEA results filename if provided.
5. Performs pairwise correlations between pathways and metabolites for each
   identified group using `stats::cor.test`.
6. Calculates adjusted p-values (q-values) for all correlations within a group.
7. Filters correlation results based on absolute correlation coefficient,
   p-value, or q-value cutoffs.
8. Saves the filtered correlation results as CSV files for each processed group.
}
